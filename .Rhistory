length(union(union(union(a,b),c),d))
cat("% Outliers = ")
length(union(union(union(a,b),c),d))/1599 * 100
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.5)
cat("Total outliers = ")
length(union(union(union(a,b),c),d))
cat("% Outliers = ")
length(union(union(union(a,b),c),d))/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.5)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.5)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- read.csv2("winequality-red.csv")
summary(X)
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.5)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 200)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
X <- read.csv2("winequality-red.csv")
summary(X)
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
summary(X)
X <- X[-outliers,]
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
summary(X)
X <- X[-outliers,]
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
summary(X)
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 && X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 && X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- read.csv2("winequality-red.csv")
summary(X)
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 && X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 && X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 || X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 || X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,2))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
X <- X[-outliers,]
par(mfrow=c(4,1))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
X <- X[-outliers,]
par(mfrow=c(1,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
par(mfrow=c(4,1))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
par(mfrow=c(1,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- read.csv2("winequality-red.csv")
summary(X)
par(mfrow=c(1,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(1,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
knitr::opts_chunk$set(echo = TRUE)
X <- read.csv2("winequality-red.csv")
summary(X)
X <- read.csv2("winequality-red.csv")
summary(X)
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
Xc <- scale(db, scale=F)
pca.out <- princomp(Xc, cor = T)
summary(pca.out)
pca.out <- princomp(db2, cor = T)
summary(pca.out)
Xc <- scale(db2, scale=F)
pca.out <- princomp(Xc, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(Xc)))
screeplot(pca.out)
pca.out <- princomp(db2, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db2)))
Xs <- scale(db2, scale=T)
pca.out <- princomp(Xs, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(Xs)))
X <- X[-outliers,]
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
X <- X[-outliers,]
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
db <- X[,-12]
cor(db)
scatterplotMatrix(sb)
db <- X[,-12]
cor(db)
scatterplotMatrix(db)
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
db <- X[,-12]
cor(db)
scatterplotMatrix(db)
db <- X[,-12]
cor(db)
scatterplotMatrix(db)
library(car)
library(FactoMineR)
library(ade4)
pca.out <- princomp(db, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db)))
biplot(pca.out, xlabs = rep(".", nrow(db)))
screeplot(pca.out)
library(car)
library(FactoMineR)
library(ade4)
pca.out <- princomp(db, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db)))
screeplot(pca.out)
library(car)
library(FactoMineR)
library(ade4)
par(mfrow = c(1,1))
pca.out <- princomp(db, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db)))
screeplot(pca.out)
library(car)
library(FactoMineR)
library(ade4)
par(mfrow = c(1,1))
pca.out <- princomp(db, cor = T)
summary(pca.out)
library(car)
library(FactoMineR)
library(ade4)
pca.out <- princomp(db, cor = T)
summary(pca.out)
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.69))
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.70))
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.70)) - 12
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.70)) - 11
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.69)) - 11
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.6)) - 11
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.3)) - 11
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0)) - 11
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.3)) - 11
X <- read.csv2("winequality-red.csv")
library(car)
library(FactoMineR)
library(ade4)
pca.out <- princomp(db, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db)))
screeplot(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db)), col = "blue")
screeplot(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db), col = "black"), col = "blue")
screeplot(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db), col = "black"))
screeplot(pca.out)
setwd("~/Google Drive/UNI/3r CURS/2n QUATRIMESTRE/ANÀLISI DE DADES/PROJECTE/wine-quality-ad")
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.3)) - 11
scatterplotMatrix(db)
X <- read.csv2("winequality-red.csv")
summary(X[,-12])
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
a <- which(X$chlorides > 0.15 | X$chlorides < 0.02)
boxplot(X[,4], main = "residual.sugar")
b <- which(X$residual.sugar > 5 | X$residual.sugar < 1)
boxplot(X[,7], main = "total.sulfur.dioxide")
c <- which(X$total.sulfur.dioxide > 150)
boxplot(X[,10], main = "sulphates")
d <- which(X$sulphates > 1.2)
outliers <- union(union(union(a,b),c),d)
cat("Total outliers = ")
length(outliers)
cat("% Outliers = ")
length(outliers)/1599 * 100
X <- X[-outliers,]
par(mfrow=c(2,4))
boxplot(X[,5], main = "chlorides")
boxplot(X[,4], main = "residual.sugar")
boxplot(X[,7], main = "total.sulfur.dioxide")
boxplot(X[,10], main = "sulphates")
db <- X[,-12]
cor(db)
length(which(abs(cor(db)) > 0.3)) - 11
library(car)
library(FactoMineR)
library(ade4)
scatterplotMatrix(db)
pca.out <- princomp(db, cor = T)
summary(pca.out)
biplot(pca.out, xlabs = rep(".", nrow(db), col = "black"))
screeplot(pca.out)
pca.out$loadings
